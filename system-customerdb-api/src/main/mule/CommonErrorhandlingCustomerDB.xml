<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<error-handler name="errorhandlingError_Handler" doc:id="d32b5709-0660-4406-b0b1-01b404d1f80a" >
		
		
            <on-error-propagate type="APIKIT:BAD_REQUEST">
                <ee:transform xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd" doc:id="d350f3db-4f80-42bb-9d94-9c6e70825e46">
                    <ee:message>
                        <ee:set-payload><![CDATA[%dw 2.0
output application/json
---
{message: "Bad request"}]]></ee:set-payload>
                    </ee:message>
                    <ee:variables>
                        <ee:set-variable variableName="httpStatus"><![CDATA[400]]></ee:set-variable>
                    </ee:variables>
                </ee:transform>
			<flow-ref doc:name="Call-global-error-response-subFlow" doc:id="9686fcba-944e-4078-b80c-973d0fe54dda" name="global-error-response-subFlow"/>
            
</on-error-propagate>
            <on-error-propagate type="APIKIT:NOT_FOUND">
                <ee:transform xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd" doc:id="a06cbd08-c4b4-42c5-b519-ee0a311c9242">
                    <ee:message>
                        <ee:set-payload><![CDATA[%dw 2.0
output application/json
---
{message: "Resource not found"}]]></ee:set-payload>
                    </ee:message>
                    <ee:variables>
                        <ee:set-variable variableName="httpStatus"><![CDATA[404]]></ee:set-variable>
                    </ee:variables>
                </ee:transform>
			<flow-ref doc:name="Call-global-error-response-subFlow" doc:id="571689bc-2e4f-40ca-8c62-c2c0200d461a" name="global-error-response-subFlow"/>
            
</on-error-propagate>
            <on-error-propagate type="APIKIT:METHOD_NOT_ALLOWED">
                <ee:transform xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd" doc:id="f0d12bd9-f3ac-443a-a96f-8fba751f5a73">
                    <ee:message>
                        <ee:set-payload><![CDATA[%dw 2.0
output application/json
---
{message: "Method not allowed"}]]></ee:set-payload>
                    </ee:message>
                    <ee:variables>
                        <ee:set-variable variableName="httpStatus"><![CDATA[405]]></ee:set-variable>
                    </ee:variables>
                </ee:transform>
			<flow-ref doc:name="Call-global-error-response-subFlow" doc:id="bf0d696a-d5b9-4cd7-8d51-54e15e0ebeff" name="global-error-response-subFlow"/>
            
</on-error-propagate>
            <on-error-propagate type="APIKIT:NOT_ACCEPTABLE">
                <ee:transform xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
                    <ee:message>
                        <ee:set-payload><![CDATA[%dw 2.0
output application/json
---
{message: "Not acceptable"}]]></ee:set-payload>
                    </ee:message>
                    <ee:variables>
                        <ee:set-variable variableName="httpStatus">406</ee:set-variable>
                    </ee:variables>
                </ee:transform>
			<flow-ref doc:name="Call-global-error-response-subFlow" doc:id="f5ac8998-0aac-4e0d-b99c-9c29bdc74bec" name="global-error-response-subFlow"/>
            
</on-error-propagate>
            <on-error-propagate type="APIKIT:UNSUPPORTED_MEDIA_TYPE">
                <ee:transform xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd" doc:id="0577bdf3-fd41-4773-b140-d8f57d191330">
                    <ee:message>
                        <ee:set-payload><![CDATA[%dw 2.0
output application/json
---
{message: "Unsupported media type"}]]></ee:set-payload>
                    </ee:message>
                    <ee:variables>
                        <ee:set-variable variableName="httpStatus"><![CDATA[415]]></ee:set-variable>
                    </ee:variables>
                </ee:transform>
			<flow-ref doc:name="Call-global-error-response-subFlow" doc:id="8f8e5cd7-08b3-412a-91ec-5bd658e11bad" name="global-error-response-subFlow"/>
            
</on-error-propagate>
            <on-error-propagate type="APIKIT:NOT_IMPLEMENTED">
                <ee:transform xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd" doc:id="17ca11fa-c3ee-47de-a65c-c8b823026f65">
                    <ee:message>
                        <ee:set-payload><![CDATA[%dw 2.0
output application/json
---
{message: "Not Implemented"}]]></ee:set-payload>
                    </ee:message>
                    <ee:variables>
                        <ee:set-variable variableName="httpStatus"><![CDATA[501]]></ee:set-variable>
                    </ee:variables>
                </ee:transform>
			<flow-ref doc:name="Call-global-error-response-subFlow" doc:id="160e0d2c-20f6-474b-8328-5e19172d382b" name="global-error-response-subFlow"/>
            
</on-error-propagate>
<on-error-propagate type="ANY" enableNotifications="true" logException="true">
			<set-variable value="#[500]" doc:name="Set HTTP STATUS -500" doc:id="b7174513-f4d9-483d-a9cd-3df8507762ec" variableName="Var_HttpStatus"/>
			<flow-ref doc:name="Call-global-error-response-subFlow" doc:id="bf2d111d-1397-4a67-b3aa-50051a52756d" name="global-error-response-subFlow"/>

</on-error-propagate>
        </error-handler>
        <sub-flow name="global-error-response-subFlow" doc:id="ab688d11-1d82-42d3-8f91-4cda2f2deb72" >
		<ee:transform doc:name="Compose-Error-Response" doc:id="d4c4e8f7-4ada-4d0c-806c-e138833f51a2">
			<ee:message>
				<ee:set-payload><![CDATA[%dw 2.0
output application/json
---
{
 "timestamp": now(),
  "message": error.errorMessage,
  "desc":error.detailedDescription,
  "error-code":vars[0],
  "error-type": error.errorType,
 "external-correlation-id": correlationId
 
 }
]]></ee:set-payload>
			</ee:message>
			<ee:variables >
			</ee:variables>
		</ee:transform>
	</sub-flow>
</mule>
